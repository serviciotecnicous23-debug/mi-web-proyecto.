/* ═══════════════════════════════════════════════════════════════════
   Ciudad del Reino — CityVille-Style Isometric City Builder
   Bright, colorful CSS-art buildings with depth and detail
   ═══════════════════════════════════════════════════════════════════ */

/* ── Grid & Terrain ──────────────────────────────────────────────── */
.city-terrain {
  background:
    radial-gradient(ellipse at 20% 30%, rgba(74, 222, 128, 0.15) 0%, transparent 50%),
    radial-gradient(ellipse at 80% 70%, rgba(74, 222, 128, 0.1) 0%, transparent 50%),
    radial-gradient(ellipse at 50% 50%, rgba(134, 239, 172, 0.08) 0%, transparent 70%),
    linear-gradient(180deg, #4ade80 0%, #22c55e 30%, #16a34a 60%, #15803d 100%);
  position: relative;
  overflow: hidden;
  border: 3px solid #15803d;
  box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.1), 0 4px 16px rgba(0, 0, 0, 0.15);
}
.dark .city-terrain {
  background:
    radial-gradient(ellipse at 20% 30%, rgba(34, 197, 94, 0.1) 0%, transparent 50%),
    radial-gradient(ellipse at 80% 70%, rgba(34, 197, 94, 0.08) 0%, transparent 50%),
    linear-gradient(180deg, #166534 0%, #14532d 40%, #052e16 100%);
  border-color: #14532d;
}

.city-isometric {
  transform: perspective(1200px) rotateX(15deg) scale(0.95);
  transform-origin: center 55%;
  transition: transform 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
}
.city-isometric:hover {
  transform: perspective(1200px) rotateX(10deg) scale(0.97);
}

.city-terrain::before {
  content: '';
  position: absolute;
  inset: 0;
  background:
    repeating-linear-gradient(0deg, transparent, transparent 11.5%, rgba(255, 255, 255, 0.04) 11.5%, rgba(255, 255, 255, 0.04) 12.5%),
    repeating-linear-gradient(90deg, transparent, transparent 11.5%, rgba(255, 255, 255, 0.04) 11.5%, rgba(255, 255, 255, 0.04) 12.5%);
  pointer-events: none;
  z-index: 0;
}

.city-terrain::after {
  content: '';
  position: absolute;
  inset: 0;
  background:
    radial-gradient(circle 3px at 15% 25%, rgba(255, 255, 255, 0.12) 0%, transparent 100%),
    radial-gradient(circle 2px at 45% 65%, rgba(255, 255, 255, 0.1) 0%, transparent 100%),
    radial-gradient(circle 4px at 75% 35%, rgba(255, 255, 255, 0.08) 0%, transparent 100%),
    radial-gradient(circle 2px at 85% 85%, rgba(255, 255, 255, 0.1) 0%, transparent 100%),
    radial-gradient(circle 3px at 35% 90%, rgba(255, 255, 255, 0.06) 0%, transparent 100%);
  pointer-events: none;
  z-index: 0;
}

/* ── Building Tile Base ──────────────────────────────────────────── */
.building-tile {
  position: relative;
  width: 100%;
  aspect-ratio: 1;
  border-radius: 8px;
  overflow: visible;
  cursor: pointer;
  transition: transform 0.2s cubic-bezier(0.34, 1.56, 0.64, 1), box-shadow 0.2s ease, filter 0.2s ease;
  z-index: 1;
  border: 1.5px solid rgba(255, 255, 255, 0.15);
}
.building-tile:hover {
  transform: translateY(-2px);
  z-index: 10;
  filter: brightness(1.06);
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
}
.building-tile:active {
  transform: translateY(0px) scale(0.98);
}

/* ── Building 3D Body ──────────────────────────────────────────── */
.building-body {
  position: absolute;
  inset: 0;
  border-radius: 8px;
  overflow: hidden;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: flex-end;
}

/* ═══════════════════════════════════════════════════════════════════
   CSS ART: CITYVILLE-STYLE BUILDINGS
   Each building is a colorful, multi-layered CSS illustration
   ═══════════════════════════════════════════════════════════════════ */

/* ── CASA (House) ─ Bright cottage with chimney & warm windows ── */
.bldg-casa .building-body {
  background: linear-gradient(180deg, #60a5fa 0%, #93c5fd 40%, #93c5fd 40%, #fbbf24 40%, #f59e0b 75%, #d97706 100%);
}
.bldg-casa .building-body::before {
  content: '';
  position: absolute;
  top: 0; left: 5%; right: 5%;
  height: 42%;
  background: linear-gradient(135deg, #dc2626 0%, #ef4444 35%, #b91c1c 65%, #991b1b 100%);
  clip-path: polygon(50% 5%, 0% 100%, 100% 100%);
  filter: drop-shadow(0 2px 2px rgba(0,0,0,0.2));
  z-index: 1;
}
.bldg-casa .building-body::after {
  content: '';
  position: absolute;
  bottom: 8%; left: 50%;
  transform: translateX(-50%);
  width: 20%; height: 28%;
  background: linear-gradient(180deg, #78350f 0%, #451a03 100%);
  border-radius: 3px 3px 0 0;
  box-shadow: inset 0 0 3px rgba(0,0,0,0.4);
  z-index: 2;
}
.bldg-casa .bldg-window {
  position: absolute;
  width: 15%; height: 13%;
  background: linear-gradient(135deg, #fef3c7 0%, #fde68a 50%, #fbbf24 100%);
  border: 1.5px solid #92400e;
  border-radius: 2px;
  box-shadow: 0 0 6px rgba(253, 230, 138, 0.8), inset 0 0 2px rgba(255,255,255,0.5);
  z-index: 2;
}
.bldg-casa .bldg-window.w1 { top: 48%; left: 16%; }
.bldg-casa .bldg-window.w2 { top: 48%; right: 16%; }

/* ── GRANJA (Farm) ─ Lush green field with golden wheat ────────── */
.bldg-granja .building-body {
  background: linear-gradient(180deg, #86efac 0%, #4ade80 25%, #22c55e 50%, #16a34a 100%);
}
.bldg-granja .building-body::before {
  content: '';
  position: absolute;
  top: 0; left: 0; right: 0;
  height: 30%;
  background: linear-gradient(180deg, #7dd3fc 0%, #bae6fd 100%);
  z-index: 0;
}
.bldg-granja .building-body::after {
  content: '';
  position: absolute;
  bottom: 0; left: 0; right: 0;
  height: 50%;
  background:
    repeating-linear-gradient(90deg, #65a30d 0px, #65a30d 2px, #84cc16 2px, #84cc16 5px, #65a30d 5px);
  z-index: 1;
}
.bldg-granja .crop-row {
  position: absolute;
  bottom: 8%;
  width: 7%;
  height: 42%;
  background: linear-gradient(to top, #65a30d 0%, #a3e635 40%, #eab308 80%, #fbbf24 100%);
  border-radius: 50% 50% 2px 2px;
  animation: crop-sway 2.5s ease-in-out infinite;
  z-index: 2;
  filter: drop-shadow(1px 1px 1px rgba(0,0,0,0.15));
}
.bldg-granja .crop-row:nth-child(1) { left: 8%; animation-delay: 0s; }
.bldg-granja .crop-row:nth-child(2) { left: 22%; animation-delay: 0.4s; height: 38%; }
.bldg-granja .crop-row:nth-child(3) { left: 36%; animation-delay: 0.8s; }
.bldg-granja .crop-row:nth-child(4) { left: 50%; animation-delay: 0.2s; height: 40%; }
.bldg-granja .crop-row:nth-child(5) { left: 64%; animation-delay: 0.6s; }
.bldg-granja .crop-row:nth-child(6) { left: 78%; animation-delay: 1s; height: 36%; }

/* ── VINEDO (Vineyard) ─ Purple vines with hanging grapes ──────── */
.bldg-vinedo .building-body {
  background: linear-gradient(180deg, #c4b5fd 0%, #a78bfa 30%, #7c3aed 60%, #5b21b6 100%);
}
.bldg-vinedo .building-body::before {
  content: '';
  position: absolute;
  bottom: 0; left: 0; right: 0;
  height: 35%;
  background: linear-gradient(180deg, #7c3aed 0%, #4c1d95 100%);
}
.bldg-vinedo .grape-cluster {
  position: absolute;
  width: 20%;
  height: 24%;
  background: radial-gradient(circle at 40% 40%, #c084fc 0%, #9333ea 40%, #7c3aed 70%, #6d28d9 100%);
  border-radius: 50% 50% 45% 45%;
  box-shadow: 0 2px 4px rgba(0,0,0,0.3), 0 0 8px rgba(168, 85, 247, 0.4);
  z-index: 2;
}
.bldg-vinedo .grape-cluster:nth-child(1) { top: 22%; left: 12%; animation: grape-bob 3s ease-in-out infinite; }
.bldg-vinedo .grape-cluster:nth-child(2) { top: 35%; left: 50%; animation: grape-bob 3s ease-in-out 1s infinite; }
.bldg-vinedo .grape-cluster:nth-child(3) { top: 50%; left: 28%; animation: grape-bob 3s ease-in-out 2s infinite; }
.bldg-vinedo .vine-line {
  position: absolute;
  left: 3%; right: 3%;
  height: 3px;
  background: linear-gradient(90deg, transparent, #15803d 10%, #22c55e 50%, #15803d 90%, transparent);
  border-radius: 2px;
  z-index: 1;
}
.bldg-vinedo .vine-line:nth-child(4) { top: 18%; }
.bldg-vinedo .vine-line:nth-child(5) { top: 42%; }

/* ── TEMPLO (Temple) ─ Majestic golden-domed temple ────────────── */
.bldg-templo .building-body {
  background: linear-gradient(180deg, #fde68a 0%, #fbbf24 15%, #e0e7ff 15%, #c7d2fe 40%, #a5b4fc 60%, #818cf8 80%, #6366f1 100%);
}
.bldg-templo .building-body::before {
  content: '';
  position: absolute;
  top: -2%; left: 20%; right: 20%;
  height: 20%;
  background: linear-gradient(180deg, #fbbf24 0%, #f59e0b 50%, #d97706 100%);
  clip-path: ellipse(50% 50% at 50% 100%);
  z-index: 3;
  filter: drop-shadow(0 1px 3px rgba(0,0,0,0.3));
}
.bldg-templo .temple-glow {
  position: absolute;
  top: 2%; left: 50%;
  transform: translateX(-50%);
  width: 30%; height: 25%;
  background: radial-gradient(circle, rgba(253, 230, 138, 1) 0%, rgba(253, 230, 138, 0.5) 40%, transparent 70%);
  border-radius: 50%;
  animation: temple-pulse 2.5s ease-in-out infinite;
  z-index: 4;
}
.bldg-templo .temple-column {
  position: absolute;
  bottom: 0;
  width: 11%;
  height: 60%;
  background: linear-gradient(90deg, #c7d2fe 0%, #e0e7ff 30%, #f0f0ff 50%, #e0e7ff 70%, #c7d2fe 100%);
  border-radius: 4px 4px 0 0;
  z-index: 2;
  box-shadow: 1px 0 2px rgba(0,0,0,0.1);
}
.bldg-templo .temple-column:nth-child(2) { left: 12%; }
.bldg-templo .temple-column:nth-child(3) { left: 32%; }
.bldg-templo .temple-column:nth-child(4) { right: 32%; }
.bldg-templo .temple-column:nth-child(5) { right: 12%; }

/* ── MERCADO (Market) ─ Colorful market stall with awning ──────── */
.bldg-mercado .building-body {
  background: linear-gradient(180deg, #fed7aa 0%, #fdba74 40%, #fb923c 70%, #ea580c 100%);
}
.bldg-mercado .building-body::before {
  content: '';
  position: absolute;
  top: 0; left: 0; right: 0;
  height: 38%;
  background: repeating-linear-gradient(
    90deg,
    #ef4444 0%, #ef4444 25%,
    #fbbf24 25%, #fbbf24 50%,
    #ef4444 50%, #ef4444 75%,
    #fbbf24 75%, #fbbf24 100%
  );
  clip-path: polygon(0 0, 100% 0, 97% 85%, 3% 85%, 0 100%, 100% 100%);
  z-index: 1;
  filter: drop-shadow(0 2px 3px rgba(0,0,0,0.2));
}
.bldg-mercado .building-body::after {
  content: '';
  position: absolute;
  bottom: 5%; left: 10%; right: 10%;
  height: 15%;
  background: linear-gradient(90deg, #92400e, #78350f, #92400e);
  border-radius: 2px;
  z-index: 1;
}
.bldg-mercado .market-item {
  position: absolute;
  width: 16%; height: 16%;
  border-radius: 50%;
  z-index: 2;
  animation: market-bounce 2s ease-in-out infinite;
  box-shadow: 0 1px 3px rgba(0,0,0,0.3);
}
.bldg-mercado .market-item:nth-child(1) { bottom: 25%; left: 15%; background: radial-gradient(circle at 35% 35%, #fde047, #eab308); animation-delay: 0s; }
.bldg-mercado .market-item:nth-child(2) { bottom: 30%; left: 43%; background: radial-gradient(circle at 35% 35%, #f87171, #dc2626); animation-delay: 0.5s; }
.bldg-mercado .market-item:nth-child(3) { bottom: 25%; right: 15%; background: radial-gradient(circle at 35% 35%, #86efac, #22c55e); animation-delay: 1s; }

/* ── PALACIO (Palace) ─ Grand golden palace with towers ────────── */
.bldg-palacio .building-body {
  background: linear-gradient(180deg, #fef3c7 0%, #fde68a 20%, #fbbf24 40%, #f59e0b 60%, #d97706 80%, #b45309 100%);
  box-shadow: inset 0 0 20px rgba(253, 224, 71, 0.4);
}
.bldg-palacio .building-body::before {
  content: '';
  position: absolute;
  top: 0; left: 10%; right: 10%;
  height: 28%;
  background: linear-gradient(135deg, #fde047 0%, #fbbf24 40%, #f59e0b 100%);
  clip-path: polygon(50% 0%, 5% 100%, 95% 100%);
  filter: drop-shadow(0 2px 3px rgba(0,0,0,0.2));
  z-index: 2;
}
.bldg-palacio .building-body::after {
  content: '';
  position: absolute;
  top: 0; left: 0;
  width: 18%; height: 55%;
  background: linear-gradient(180deg, #fde047 0%, #eab308 100%);
  border-radius: 0 0 3px 3px;
  box-shadow: 2px 0 4px rgba(0,0,0,0.15);
  z-index: 1;
}
.bldg-palacio .palace-crown {
  position: absolute;
  top: -2%; left: 50%;
  transform: translateX(-50%);
  width: 28%; height: 20%;
  color: #fde047;
  animation: crown-shimmer 3s ease-in-out infinite;
  filter: drop-shadow(0 0 6px rgba(253, 224, 71, 0.9));
  z-index: 5;
}
.bldg-palacio .palace-pillar {
  position: absolute;
  bottom: 0;
  width: 14%;
  height: 65%;
  background: linear-gradient(90deg, #d97706 0%, #fbbf24 30%, #fde047 50%, #fbbf24 70%, #d97706 100%);
  border-radius: 4px 4px 0 0;
  z-index: 2;
  box-shadow: 1px 0 3px rgba(0,0,0,0.15);
}
.bldg-palacio .palace-pillar:nth-child(2) { left: 18%; }
.bldg-palacio .palace-pillar:nth-child(3) { right: 18%; }

/* ── POZO (Well) ─ Stone well with animated water ──────────────── */
.bldg-pozo .building-body {
  background: linear-gradient(180deg, #bae6fd 0%, #38bdf8 30%, #0ea5e9 60%, #0369a1 100%);
}
.bldg-pozo .building-body::before {
  content: '';
  position: absolute;
  top: 15%; left: 20%; right: 20%;
  height: 25%;
  background: linear-gradient(180deg, #a8a29e 0%, #78716c 100%);
  border-radius: 50%;
  z-index: 2;
  box-shadow: 0 2px 4px rgba(0,0,0,0.3);
}
.bldg-pozo .building-body::after {
  content: '';
  position: absolute;
  top: 8%; left: 42%; right: 42%;
  height: 20%;
  background: linear-gradient(90deg, #78350f 0%, #92400e 50%, #78350f 100%);
  border-radius: 2px;
  z-index: 3;
}
.bldg-pozo .water-ripple {
  position: absolute;
  bottom: 12%;
  left: 50%; transform: translateX(-50%);
  width: 55%; height: 28%;
  border: 2px solid rgba(186, 230, 253, 0.7);
  border-radius: 50%;
  animation: water-ripple 2.5s ease-out infinite;
  z-index: 1;
}
.bldg-pozo .water-ripple:nth-child(2) { animation-delay: 0.8s; width: 38%; height: 18%; }
.bldg-pozo .water-ripple:nth-child(3) { animation-delay: 1.6s; width: 22%; height: 12%; }

/* ── ASERRADERO (Sawmill) ─ Wooden building with spinning blade ── */
.bldg-aserradero .building-body {
  background: linear-gradient(180deg, #92400e 0%, #a3622a 30%, #92400e 50%, #78350f 80%, #451a03 100%);
}
.bldg-aserradero .building-body::before {
  content: '';
  position: absolute;
  top: 0; left: 8%; right: 8%;
  height: 35%;
  background: linear-gradient(135deg, #78350f 0%, #92400e 40%, #78350f 100%);
  clip-path: polygon(50% 0%, 0% 100%, 100% 100%);
  z-index: 1;
}
.bldg-aserradero .log-stack {
  position: absolute;
  bottom: 5%;
  width: 75%; left: 12%;
  height: 22%;
  background:
    repeating-linear-gradient(0deg, #b45309 0px, #b45309 3px, #92400e 3px, #92400e 4px, #78350f 4px, #78350f 5px);
  border-radius: 3px;
  z-index: 2;
  box-shadow: 0 1px 3px rgba(0,0,0,0.3);
}
.bldg-aserradero .saw-blade {
  position: absolute;
  top: 18%; left: 50%;
  transform: translateX(-50%);
  width: 32%; height: 32%;
  border: 3px solid #d4d4d8;
  border-radius: 50%;
  animation: saw-spin 1s linear infinite;
  z-index: 2;
  background: radial-gradient(circle, transparent 60%, rgba(212,212,216,0.2) 100%);
}
.bldg-aserradero .saw-blade::after {
  content: '';
  position: absolute;
  top: 50%; left: 50%;
  transform: translate(-50%, -50%);
  width: 25%; height: 25%;
  background: radial-gradient(circle, #a1a1aa, #71717a);
  border-radius: 50%;
}

/* ── CANTERA (Quarry) ─ Rocky quarry with stone blocks ─────────── */
.bldg-cantera .building-body {
  background: linear-gradient(160deg, #d6d3d1 0%, #a8a29e 30%, #78716c 60%, #57534e 100%);
}
.bldg-cantera .building-body::before {
  content: '';
  position: absolute;
  top: 0; left: 0; right: 0; bottom: 0;
  background:
    radial-gradient(circle 5px at 20% 30%, rgba(0,0,0,0.1) 0%, transparent 100%),
    radial-gradient(circle 4px at 70% 60%, rgba(0,0,0,0.08) 0%, transparent 100%),
    radial-gradient(circle 3px at 40% 80%, rgba(0,0,0,0.1) 0%, transparent 100%);
  z-index: 0;
}
.bldg-cantera .stone-block {
  position: absolute;
  background: linear-gradient(145deg, #d6d3d1 0%, #a8a29e 50%, #78716c 100%);
  border: 1.5px solid #57534e;
  border-radius: 3px;
  z-index: 1;
  box-shadow: 1px 1px 3px rgba(0,0,0,0.25);
}
.bldg-cantera .stone-block:nth-child(1) { bottom: 5%; left: 8%; width: 38%; height: 28%; }
.bldg-cantera .stone-block:nth-child(2) { bottom: 5%; right: 8%; width: 32%; height: 22%; }
.bldg-cantera .stone-block:nth-child(3) { bottom: 32%; left: 22%; width: 28%; height: 20%; }

/* ── OLIVAR (Olive grove) ─ Green trees with brown trunks ──────── */
.bldg-olivar .building-body {
  background: linear-gradient(180deg, #bbf7d0 0%, #4ade80 30%, #22c55e 60%, #16a34a 100%);
}
.bldg-olivar .olive-tree {
  position: absolute;
  bottom: 5%;
  width: 28%; height: 72%;
  z-index: 1;
}
.bldg-olivar .olive-tree::before {
  content: '';
  position: absolute;
  bottom: 0; left: 50%;
  transform: translateX(-50%);
  width: 18%; height: 38%;
  background: linear-gradient(90deg, #78350f, #92400e, #78350f);
  border-radius: 2px;
}
.bldg-olivar .olive-tree::after {
  content: '';
  position: absolute;
  top: 0; left: 50%;
  transform: translateX(-50%);
  width: 110%; height: 68%;
  background: radial-gradient(ellipse at 45% 45%, #86efac 0%, #4ade80 30%, #22c55e 60%, #16a34a 100%);
  border-radius: 50%;
  animation: tree-sway 4s ease-in-out infinite;
  filter: drop-shadow(0 2px 2px rgba(0,0,0,0.15));
}
.bldg-olivar .olive-tree:nth-child(1) { left: 3%; }
.bldg-olivar .olive-tree:nth-child(2) { left: 36%; animation-delay: 1.3s; }
.bldg-olivar .olive-tree:nth-child(3) { left: 68%; animation-delay: 2.6s; }

/* ── HUERTO (Orchard) ─ Fruit trees with red apples ────────────── */
.bldg-huerto .building-body {
  background: linear-gradient(180deg, #d9f99d 0%, #a3e635 30%, #84cc16 60%, #65a30d 100%);
}
.bldg-huerto .fruit-tree {
  position: absolute;
  bottom: 5%;
  width: 26%; height: 68%;
  z-index: 1;
}
.bldg-huerto .fruit-tree::before {
  content: '';
  position: absolute;
  bottom: 0; left: 50%;
  transform: translateX(-50%);
  width: 15%; height: 36%;
  background: linear-gradient(90deg, #78350f, #92400e, #78350f);
}
.bldg-huerto .fruit-tree::after {
  content: '';
  position: absolute;
  top: 0; left: 50%;
  transform: translateX(-50%);
  width: 105%; height: 70%;
  background: radial-gradient(ellipse at 45% 45%, #d9f99d 0%, #a3e635 30%, #65a30d 100%);
  border-radius: 50%;
  animation: tree-sway 3.5s ease-in-out infinite;
  filter: drop-shadow(0 2px 2px rgba(0,0,0,0.15));
}
.bldg-huerto .fruit-tree:nth-child(1) { left: 5%; }
.bldg-huerto .fruit-tree:nth-child(2) { left: 37%; animation-delay: 0.8s; }
.bldg-huerto .fruit-tree:nth-child(3) { left: 69%; animation-delay: 1.6s; }
.bldg-huerto .fruit-dot {
  position: absolute;
  width: 11%; height: 11%;
  background: radial-gradient(circle at 35% 35%, #fca5a5, #ef4444, #dc2626);
  border-radius: 50%;
  box-shadow: 0 1px 2px rgba(0,0,0,0.3), 0 0 4px rgba(239, 68, 68, 0.3);
  z-index: 2;
}
.bldg-huerto .fruit-dot:nth-child(4) { top: 15%; left: 12%; }
.bldg-huerto .fruit-dot:nth-child(5) { top: 22%; left: 48%; }
.bldg-huerto .fruit-dot:nth-child(6) { top: 12%; right: 18%; }

/* ── MURALLA (Wall) ─ Stone fortress wall with merlons ─────────── */
.bldg-muralla .building-body {
  background: linear-gradient(180deg, #d6d3d1 0%, #a8a29e 40%, #78716c 100%);
}
.bldg-muralla .building-body::before {
  content: '';
  position: absolute;
  inset: 0;
  background:
    repeating-linear-gradient(90deg, transparent, transparent 22%, rgba(0,0,0,0.08) 22%, rgba(0,0,0,0.08) 24%),
    repeating-linear-gradient(0deg, transparent, transparent 30%, rgba(0,0,0,0.06) 30%, rgba(0,0,0,0.06) 32%);
  z-index: 0;
}
.bldg-muralla .wall-brick {
  position: absolute;
  background: linear-gradient(145deg, #d6d3d1, #a8a29e);
  border: 1px solid #78716c;
  z-index: 1;
}
.bldg-muralla .wall-brick:nth-child(1) { bottom: 0; left: 0; width: 50%; height: 38%; }
.bldg-muralla .wall-brick:nth-child(2) { bottom: 0; right: 0; width: 50%; height: 38%; }
.bldg-muralla .wall-brick:nth-child(3) { bottom: 38%; left: 10%; width: 42%; height: 28%; }
.bldg-muralla .wall-brick:nth-child(4) { bottom: 38%; right: 10%; width: 42%; height: 28%; }
.bldg-muralla .wall-merlon {
  position: absolute;
  top: 0;
  width: 20%; height: 22%;
  background: linear-gradient(145deg, #d6d3d1, #a8a29e);
  border: 1px solid #78716c;
  border-radius: 2px 2px 0 0;
  z-index: 2;
}
.bldg-muralla .wall-merlon:nth-child(5) { left: 3%; }
.bldg-muralla .wall-merlon:nth-child(6) { left: 27%; }
.bldg-muralla .wall-merlon:nth-child(7) { right: 27%; }
.bldg-muralla .wall-merlon:nth-child(8) { right: 3%; }

/* ── GRANERO (Barn) ─ Classic red barn with gambrel roof ───────── */
.bldg-granero .building-body {
  background: linear-gradient(180deg, #fca5a5 0%, #ef4444 20%, #dc2626 50%, #b91c1c 100%);
}
.bldg-granero .building-body::before {
  content: '';
  position: absolute;
  top: 0; left: 3%; right: 3%;
  height: 38%;
  background: linear-gradient(135deg, #b91c1c 0%, #dc2626 40%, #ef4444 60%, #dc2626 100%);
  clip-path: polygon(50% 0%, 0% 100%, 100% 100%);
  filter: drop-shadow(0 2px 3px rgba(0,0,0,0.2));
  z-index: 1;
}
.bldg-granero .building-body::after {
  content: '';
  position: absolute;
  top: 10%; left: 50%;
  transform: translateX(-50%);
  width: 0; height: 0;
  border-left: 6px solid transparent;
  border-right: 6px solid transparent;
  border-bottom: 8px solid #fbbf24;
  z-index: 2;
}
.bldg-granero .barn-door {
  position: absolute;
  bottom: 3%; left: 50%;
  transform: translateX(-50%);
  width: 32%; height: 42%;
  background: linear-gradient(180deg, #78350f 0%, #451a03 100%);
  border-radius: 40% 40% 0 0;
  border: 2px solid #451a03;
  z-index: 2;
  box-shadow: inset 0 0 4px rgba(0,0,0,0.4);
}

/* ── TORRE_VIGIA (Watchtower) ─ Tall stone tower with beacon ───── */
.bldg-torre_vigia .building-body {
  background: linear-gradient(180deg, #9ca3af 0%, #6b7280 30%, #4b5563 60%, #374151 100%);
}
.bldg-torre_vigia .tower-body {
  position: absolute;
  bottom: 0; left: 22%; right: 22%;
  height: 82%;
  background: linear-gradient(90deg, #4b5563 0%, #6b7280 30%, #9ca3af 50%, #6b7280 70%, #4b5563 100%);
  border-radius: 3px 3px 0 0;
  z-index: 1;
  box-shadow: 2px 0 4px rgba(0,0,0,0.2);
}
.bldg-torre_vigia .tower-body::after {
  content: '';
  position: absolute;
  top: 30%; left: 50%;
  transform: translateX(-50%);
  width: 35%; height: 15%;
  background: rgba(0,0,0,0.3);
  border-radius: 2px;
}
.bldg-torre_vigia .tower-top {
  position: absolute;
  top: 0; left: 12%; right: 12%;
  height: 22%;
  background: linear-gradient(180deg, #9ca3af, #6b7280);
  clip-path: polygon(50% 0%, 100% 100%, 0% 100%);
  z-index: 2;
  filter: drop-shadow(0 1px 2px rgba(0,0,0,0.3));
}
.bldg-torre_vigia .tower-light {
  position: absolute;
  top: 2%; left: 50%;
  transform: translateX(-50%);
  width: 18%; height: 18%;
  background: radial-gradient(circle, #fde047 0%, #fbbf24 40%, transparent 70%);
  border-radius: 50%;
  animation: beacon-flash 1.5s ease-in-out infinite;
  z-index: 3;
}

/* ── ESCUELA (School) ─ Blue schoolhouse with windows ──────────── */
.bldg-escuela .building-body {
  background: linear-gradient(180deg, #93c5fd 0%, #3b82f6 30%, #2563eb 60%, #1d4ed8 100%);
}
.bldg-escuela .building-body::before {
  content: '';
  position: absolute;
  top: 0; left: 15%; right: 15%;
  height: 32%;
  background: linear-gradient(135deg, #1e40af 0%, #2563eb 40%, #3b82f6 60%, #2563eb 100%);
  clip-path: polygon(50% 0%, 0% 100%, 100% 100%);
  z-index: 1;
  filter: drop-shadow(0 2px 2px rgba(0,0,0,0.2));
}
.bldg-escuela .building-body::after {
  content: '';
  position: absolute;
  bottom: 6%; left: 50%;
  transform: translateX(-50%);
  width: 18%; height: 25%;
  background: linear-gradient(180deg, #1e3a5f, #0f172a);
  border-radius: 2px 2px 0 0;
  z-index: 2;
}
.bldg-escuela .school-window {
  position: absolute;
  width: 16%; height: 14%;
  background: linear-gradient(135deg, #fef3c7 0%, #fde68a 50%, #fbbf24 100%);
  border: 1.5px solid #1e40af;
  border-radius: 2px;
  box-shadow: 0 0 5px rgba(254, 243, 199, 0.5);
  z-index: 2;
}
.bldg-escuela .school-window:nth-child(1) { top: 42%; left: 10%; }
.bldg-escuela .school-window:nth-child(2) { top: 42%; left: 42%; }
.bldg-escuela .school-window:nth-child(3) { top: 42%; right: 10%; }

/* ═══════════════════════════════════════════════════════════════════
   DECORATIVE OVERLAYS & EFFECTS
   ═══════════════════════════════════════════════════════════════════ */

/* ── Building Shadow (ground) ──────────────────────────────────── */
.building-shadow {
  position: absolute;
  bottom: -5px; left: 8%; right: 8%;
  height: 10px;
  background: radial-gradient(ellipse at center, rgba(0,0,0,0.25) 0%, transparent 70%);
  border-radius: 50%;
  pointer-events: none;
  z-index: 0;
}

/* ── Building Highlight (light reflection) ─────────────────────── */
.building-highlight {
  position: absolute;
  inset: 0;
  border-radius: 8px;
  background: linear-gradient(135deg, rgba(255,255,255,0.22) 0%, rgba(255,255,255,0.08) 30%, transparent 60%);
  pointer-events: none;
  z-index: 3;
}

/* ═══════════════════════════════════════════════════════════════════
   STATE EFFECTS
   ═══════════════════════════════════════════════════════════════════ */

/* ── Construction state ────────────────────────────────────────── */
.building-constructing {
  animation: construct-wobble 0.6s ease-in-out infinite alternate;
}
.building-constructing::after {
  content: '';
  position: absolute;
  inset: 0;
  background: repeating-linear-gradient(
    45deg,
    transparent, transparent 4px,
    rgba(251, 191, 36, 0.2) 4px, rgba(251, 191, 36, 0.2) 8px
  );
  border-radius: 8px;
  animation: scaffold-scroll 0.8s linear infinite;
  pointer-events: none;
  z-index: 4;
}

/* ── Ready to harvest ──────────────────────────────────────────── */
.building-ready-glow {
  box-shadow: 0 0 14px rgba(34, 197, 94, 0.6), 0 0 28px rgba(34, 197, 94, 0.25);
  animation: ready-glow-pulse 1.5s ease-in-out infinite;
}
.building-ready-glow::after {
  content: '';
  position: absolute;
  inset: -3px;
  border-radius: 11px;
  border: 2px solid rgba(34, 197, 94, 0.5);
  animation: ready-border-pulse 1.5s ease-in-out infinite;
  pointer-events: none;
  z-index: 4;
}

/* ── Producing state ───────────────────────────────────────────── */
.building-producing {
  box-shadow: 0 0 8px rgba(245, 158, 11, 0.3);
}

.production-indicator {
  position: absolute;
  top: -3px; right: -3px;
  width: 12px; height: 12px;
  border-radius: 50%;
  background: linear-gradient(135deg, #fbbf24, #f59e0b);
  animation: prod-blink 1s ease-in-out infinite;
  box-shadow: 0 0 8px rgba(245, 158, 11, 0.7), 0 1px 2px rgba(0,0,0,0.2);
  z-index: 5;
  border: 1.5px solid rgba(255,255,255,0.5);
}

/* ═══════════════════════════════════════════════════════════════════
   PARTICLE EFFECTS
   ═══════════════════════════════════════════════════════════════════ */

/* ── Smoke Effect ────────────────────────────────────────────────── */
.smoke-particle {
  position: absolute;
  width: 8px; height: 8px;
  background: radial-gradient(circle, rgba(200, 200, 200, 0.7) 0%, rgba(200, 200, 200, 0.1) 70%);
  border-radius: 50%;
  animation: smoke-rise 3s ease-out infinite;
  pointer-events: none;
  z-index: 4;
}
.smoke-particle:nth-child(1) { left: 62%; animation-delay: 0s; }
.smoke-particle:nth-child(2) { left: 68%; animation-delay: 1s; }
.smoke-particle:nth-child(3) { left: 58%; animation-delay: 2s; }

/* ── Sparkle / Faith Effect ──────────────────────────────────────── */
.sparkle-effect {
  position: absolute;
  width: 5px; height: 5px;
  background: #fde047;
  border-radius: 50%;
  animation: sparkle-float 2.5s ease-out infinite;
  pointer-events: none;
  box-shadow: 0 0 6px #fde047, 0 0 12px rgba(253, 224, 71, 0.3);
  z-index: 4;
}
.sparkle-effect:nth-child(1) { left: 20%; top: 10%; animation-delay: 0s; }
.sparkle-effect:nth-child(2) { left: 60%; top: 15%; animation-delay: 0.8s; }
.sparkle-effect:nth-child(3) { left: 40%; top: 5%; animation-delay: 1.6s; }
.bldg-templo .sparkle-effect:nth-child(6) { left: 20%; top: 10%; animation-delay: 0s; }
.bldg-templo .sparkle-effect:nth-child(7) { left: 60%; top: 15%; animation-delay: 0.8s; }
.bldg-templo .sparkle-effect:nth-child(8) { left: 40%; top: 5%; animation-delay: 1.6s; }

/* ── Harvest Float Effect ────────────────────────────────────────── */
.harvest-float {
  position: absolute;
  top: 0; left: 50%;
  transform: translateX(-50%);
  animation: harvest-float-up 1.2s ease-out forwards;
  pointer-events: none;
  z-index: 20;
  font-weight: 700;
  font-size: 12px;
  text-shadow: 0 1px 3px rgba(0,0,0,0.4), 0 0 6px rgba(255,255,255,0.3);
}

/* ═══════════════════════════════════════════════════════════════════
   UI ELEMENTS
   ═══════════════════════════════════════════════════════════════════ */

/* ── Empty Tile ──────────────────────────────────────────────────── */
.empty-tile {
  position: relative;
  width: 100%;
  aspect-ratio: 1;
  border-radius: 8px;
  border: 2px dashed rgba(255, 255, 255, 0.2);
  background:
    radial-gradient(ellipse at 50% 50%, rgba(255, 255, 255, 0.06) 0%, transparent 70%);
  cursor: pointer;
  transition: all 0.25s cubic-bezier(0.34, 1.56, 0.64, 1);
  display: flex;
  align-items: center;
  justify-content: center;
}
.empty-tile:hover {
  border-color: rgba(255, 255, 255, 0.45);
  background:
    radial-gradient(ellipse at 50% 50%, rgba(255, 255, 255, 0.12) 0%, transparent 70%);
  transform: translateY(-1px);
}

/* ── Timer Overlay ───────────────────────────────────────────────── */
.tile-timer {
  position: absolute;
  bottom: 0; left: 0; right: 0;
  background: linear-gradient(to top, rgba(0,0,0,0.75), rgba(0,0,0,0.45));
  color: white;
  font-size: 9px;
  text-align: center;
  padding: 2px 0;
  border-radius: 0 0 6px 6px;
  font-variant-numeric: tabular-nums;
  backdrop-filter: blur(3px);
  z-index: 4;
  font-weight: 600;
}

/* ── Level Badge ─────────────────────────────────────────────────── */
.tile-level-badge {
  position: absolute;
  top: -2px; left: -2px;
  background: linear-gradient(135deg, #fbbf24, #f59e0b);
  color: white;
  font-size: 8px;
  font-weight: 700;
  padding: 0 4px;
  border-radius: 0 0 6px 0;
  line-height: 15px;
  box-shadow: 0 1px 3px rgba(0,0,0,0.3);
  z-index: 5;
  border: 1px solid rgba(255,255,255,0.3);
}

/* ── Ready Indicator ─────────────────────────────────────────────── */
.ready-indicator {
  position: absolute;
  top: -5px; right: -5px;
  width: 16px; height: 16px;
  background: linear-gradient(135deg, #4ade80, #22c55e, #16a34a);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 0 8px rgba(34, 197, 94, 0.7), 0 2px 4px rgba(0,0,0,0.3);
  z-index: 5;
  animation: ready-indicator-bounce 1s ease-in-out infinite;
  border: 1.5px solid rgba(255,255,255,0.5);
}

/* ── Building Name Label ─────────────────────────────────────────── */
.building-name {
  position: absolute;
  bottom: 1px; left: 0; right: 0;
  text-align: center;
  font-size: 7px;
  font-weight: 700;
  color: white;
  text-shadow: 0 1px 2px rgba(0,0,0,0.7), 0 0 4px rgba(0,0,0,0.4);
  pointer-events: none;
  line-height: 1.1;
  padding: 1px 2px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  z-index: 4;
  letter-spacing: 0.3px;
}

/* ═══════════════════════════════════════════════════════════════════
   KEYFRAME ANIMATIONS
   ═══════════════════════════════════════════════════════════════════ */

@keyframes crop-sway {
  0%, 100% { transform: rotate(-4deg); }
  50% { transform: rotate(4deg); }
}

@keyframes grape-bob {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-3px); }
}

@keyframes temple-pulse {
  0%, 100% { opacity: 0.5; transform: translateX(-50%) scale(1); }
  50% { opacity: 1; transform: translateX(-50%) scale(1.4); }
}

@keyframes water-ripple {
  0% { opacity: 0.9; transform: translateX(-50%) scale(0.4); }
  100% { opacity: 0; transform: translateX(-50%) scale(1.6); }
}

@keyframes saw-spin {
  0% { transform: translateX(-50%) rotate(0deg); }
  100% { transform: translateX(-50%) rotate(360deg); }
}

@keyframes tree-sway {
  0%, 100% { transform: translateX(-50%) rotate(-2.5deg); }
  50% { transform: translateX(-50%) rotate(2.5deg); }
}

@keyframes beacon-flash {
  0%, 100% { opacity: 0.2; }
  50% { opacity: 1; }
}

@keyframes market-bounce {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-3px); }
}

@keyframes crown-shimmer {
  0%, 100% { filter: drop-shadow(0 0 4px rgba(253, 224, 71, 0.6)); }
  50% { filter: drop-shadow(0 0 12px rgba(253, 224, 71, 1)); }
}

@keyframes smoke-rise {
  0% { transform: translateY(0) scale(0.4); opacity: 0.7; }
  50% { transform: translateY(-18px) translateX(4px) scale(1.1); opacity: 0.3; }
  100% { transform: translateY(-35px) translateX(-3px) scale(1.6); opacity: 0; }
}

@keyframes sparkle-float {
  0% { transform: translateY(0) scale(0); opacity: 0; }
  15% { transform: translateY(-4px) scale(1.2); opacity: 1; }
  100% { transform: translateY(-25px) scale(0); opacity: 0; }
}

@keyframes construct-wobble {
  0% { transform: translateY(0) scale(1); }
  100% { transform: translateY(-2px) scale(1.02); }
}

@keyframes scaffold-scroll {
  0% { background-position: 0 0; }
  100% { background-position: 12px 12px; }
}

@keyframes ready-glow-pulse {
  0%, 100% { box-shadow: 0 0 10px rgba(34, 197, 94, 0.35), 0 0 20px rgba(34, 197, 94, 0.15); }
  50% { box-shadow: 0 0 20px rgba(34, 197, 94, 0.7), 0 0 40px rgba(34, 197, 94, 0.35); }
}

@keyframes ready-border-pulse {
  0%, 100% { border-color: rgba(34, 197, 94, 0.25); }
  50% { border-color: rgba(34, 197, 94, 0.7); }
}

@keyframes ready-indicator-bounce {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.2); }
}

@keyframes prod-blink {
  0%, 100% { opacity: 1; transform: scale(1); }
  50% { opacity: 0.4; transform: scale(0.85); }
}

@keyframes harvest-float-up {
  0% { transform: translateX(-50%) translateY(0); opacity: 1; }
  100% { transform: translateX(-50%) translateY(-35px); opacity: 0; }
}

@keyframes pickaxe-swing {
  0%, 100% { transform: rotate(0deg); }
  50% { transform: rotate(-25deg); }
}

/* ═══════════════════════════════════════════════════════════════════
   RESOURCE BAR
   ═══════════════════════════════════════════════════════════════════ */
.resource-pill {
  display: flex;
  align-items: center;
  gap: 4px;
  padding: 4px 10px;
  border-radius: 9999px;
  background: linear-gradient(135deg, rgba(0,0,0,0.04), rgba(0,0,0,0.08));
  border: 1px solid rgba(0,0,0,0.08);
  font-size: 12px;
  font-weight: 700;
  font-variant-numeric: tabular-nums;
  transition: transform 0.15s ease, box-shadow 0.15s ease;
}
.dark .resource-pill {
  background: linear-gradient(135deg, rgba(255,255,255,0.06), rgba(255,255,255,0.1));
  border-color: rgba(255,255,255,0.1);
}
.resource-pill:hover {
  transform: scale(1.06);
  box-shadow: 0 2px 6px rgba(0,0,0,0.1);
}

/* ═══════════════════════════════════════════════════════════════════
   AMBIENT ELEMENTS
   ═══════════════════════════════════════════════════════════════════ */

/* ── Floating Clouds ─────────────────────────────────────────────── */
.ambient-cloud {
  position: absolute;
  width: 70px; height: 22px;
  background: radial-gradient(ellipse, rgba(255,255,255,0.2) 0%, rgba(255,255,255,0.05) 70%, transparent 100%);
  border-radius: 50%;
  animation: cloud-drift 30s linear infinite;
  pointer-events: none;
  z-index: 0;
  filter: blur(1px);
}
.ambient-cloud:nth-child(1) { top: 5%; animation-duration: 32s; width: 80px; }
.ambient-cloud:nth-child(2) { top: 18%; animation-duration: 42s; animation-delay: -12s; width: 90px; height: 25px; }
.ambient-cloud:nth-child(3) { top: 30%; animation-duration: 38s; animation-delay: -22s; width: 60px; }

@keyframes cloud-drift {
  0% { left: -100px; }
  100% { left: calc(100% + 100px); }
}

/* ── Selected Tile Ring ──────────────────────────────────────────── */
.tile-selected {
  outline: 2px solid hsl(var(--primary));
  outline-offset: 2px;
  border-radius: 8px;
}

/* ═══════════════════════════════════════════════════════════════════
   RESPONSIVE: Prevent isometric on very small screens
   ═══════════════════════════════════════════════════════════════════ */
@media (max-width: 480px) {
  .city-isometric {
    transform: perspective(1200px) rotateX(8deg) scale(0.96);
  }
  .city-isometric:hover {
    transform: perspective(1200px) rotateX(5deg) scale(0.98);
  }
}
